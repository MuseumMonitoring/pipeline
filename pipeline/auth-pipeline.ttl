@prefix owl: <http://www.w3.org/2002/07/owl#>.
@prefix rdfl: <https://w3id.org/rdf-lens/ontology#>.
@prefix rdfc: <https://w3id.org/rdf-connect#>.

<> owl:imports <../node_modules/@rdfc/js-runner/index.ttl>.
<> owl:imports <../proc/acl_auth.ttl>.
<> owl:imports <../proc/css.ttl>.
<> owl:imports <../proc/webIdBuilder.ttl>.
<> a rdfc:Pipeline;
  rdfc:consistsOf [
    rdfc:instantiates rdfc:NodeRunner;
    rdfc:processor <css>, <auth>, <builder>;
  ].

<auth> a rdfc:AclAuth;
  rdfc:usersUrl [
    a rdfl:EnvVariable;
    rdfl:envDefault "http://localhost:8080/history.php?users";
    rdfl:envKey "userHistory";
  ];
  rdfc:groupsUrl [
    a rdfl:EnvVariable;
    rdfl:envDefault "http://localhost:8080/history.php?groups";
    rdfl:envKey "groupHistory";
  ];
  rdfc:sensorsUrl [
    a rdfl:EnvVariable;
    rdfl:envDefault "http://localhost:8080/history.php?sensors";
    rdfl:envKey "sensorHistory";
  ];
  rdfc:port 7111;
  rdfc:interval 5000;
  rdfc:protected "/data/", "/sensors/";
  rdfc:public "/sensors/by-location/.acl",
    "/sensors/by-location/root/.acl",
    "/sensors/by-name/.acl",
    "/sensors/by-name/root/.acl",
    "/data/by-location/.acl",
    "/data/by-location/root/.acl",
    "/data/by-sensor/.acl",
    "/data/by-sensor/root/.acl".

<css> a rdfc:Css;
  rdfc:config <./css_config.json>;
  rdfc:baseUrl _:baseUrl;
  rdfc:path <./ldes/>;
  rdfc:mainModulePath <../>.

<builder> a rdfc:WebIdBuilder;
  rdfc:baseUrl _:baseUrl;
  rdfc:port 3002;
  rdfc:timeout 7000.

_:baseUrl a rdfl:EnvVariable;
  a rdfl:EnvVariable;
  rdfl:envDefault "http://localhost:3000/";
  rdfl:envKey "baseUrl".

